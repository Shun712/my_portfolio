# 題材
家庭菜園で作りすぎた作物を近所にお裾分けできるアプリ

# 動機
- 実家で家庭菜園をしているが、作りすぎて余った分は親戚や近所の人にお裾分けしたり、腐って悪くなる前にジャムやソースなどにして加工して保存している。

- 現在はコロナで開催できないが、親戚やその友人を呼んで春と秋にじゃがいも掘りやさつまいも掘りを開催している。その際に他の作物もお土産として参加者に渡している。 

- 作物は時間とともに加工しない限り悪くなってしまうので、近所に欲しい人がいないかマッチングできるようにする。

- 宅配ではなく、消費者が直接取りに行くことで生産者の負担をなくす。

# どんな課題を解決しているか？
- フードロスを減らす

- 処理に困っている人の手助けになる

- 生産者の顔が見える安心

- 地域コミュニティの関係希薄化を改善

# 目的

- 地元地域での相互支援

- 地域単位での自給自足

- 地産地消

- 生産者の顔が見える

# 画面遷移図
https://www.figma.com/file/bCLhhsW8V6k5k5c3SBRGPv/%E3%81%8A%E3%81%99%E3%81%9D%E5%88%86%E3%81%91%E3%82%A2%E3%83%97%E3%83%AA?node-id=0%3A1

## 修正点

#### 追加
- マイページ編集
- 作物編集ページ
- チャットページのルート表示フォームと受け渡し時間フォーム
- 予約リストの取消ボタン
- 出品リスト(生産者専用)
- フォロー、フォロワーリスト

#### 削除
- サブスク機能

# テーブル設計
[![Image from Gyazo](https://i.gyazo.com/d5f66151810cec60e19bff404abe350b.png)](https://gyazo.com/d5f66151810cec60e19bff404abe350b)

## 修正点

#### 追加
- feedbacksテーブル
- 生産者が複数の農園住所を登録できるようにfarmsテーブルを追加。ルート表示に用いる住所データはデフォルトでusersテーブルのものを用いる。


#### 削除
- usersテーブルのzipcodeカラム
- サブスク関連のテーブル

## 補足説明

#### 通知機能、リスト化
- 通知機能はポリモーフィック関連で実装し、フォロー、予約、いいね、チャット受信をしたら通知される。

- フォロー、予約、いいねテーブルはそれぞれリスト一覧としても使う。

- 予約通知は生産者側と消費者側で文言を変える。
```ruby
if current_user.id == @crop.user.id
# 生産者側: 2022年3月8日17:00に消費者へ注文を引き渡す予定です。
else
# 消費者側: 2022年3月8日17:00に生産者から注文を受け取る予定です。
end
```

#### reservationsテーブル

- 予約時に受け取り希望日時をreceived_atカラムに保存する。

#### cropsテーブル
- GoogleMapAPIを用いて生産者の住所データから座標を特定して、消費者から生産者までのルートを提供する。これを用いて、作物一覧でユーザーに表示されるのは生産者との距離が5km以内の作物に限り表示される。また、生産者までのルートをチャット内でマップ表示できるようにしたいが、実装ができるか未定である。